<!DOCTYPE html>
<html>
    <head>
        <title> Gruppe 3 </title>
        <link rel="stylesheet" type="text/css" href="css/normalize.css">
        <link rel="stylesheet" type="text/css" href="css/Grid.css">
        <link rel="stylesheet" type="text/css" href="css/style.css">
        <link href="https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,100;0,300;0,400;1,300&display=swap" rel="stylesheet">
    </head>
    <body>
    <div id = "wrapper">

        <div id="nav">
            <a href="template.html">Hjem</a>
            <a href = "om.html">Om oss</a>
        </div>


        <p>Click the button to get your coordinates.</p>

        <button onclick="getLocation()">Try It</button>
        <button onclick="moveMap()">Move map</button><br><br>
        <label for="search">Søk på adresse:</label>
        <input type="text" id="search" name="search"><br>
        <button id="searchBtn" onclick="geocodeAddress()">Søk</button>

        <p id="demo"></p>
        <h3>My Google Maps Demo</h3>
        <!--The div element for the map -->
        <div id="map"></div>
        
        
        <p id = "regist">
          <button>
            <a href = "registrer.html">Registrer</a>
          </button>
        </p>
        
      <!--Logg inn-->
        <p id = "logg-inn">
          <button id ="knapp">
            <a href = "registrer.html">Logg inn</a>
          </button>     
        </p>
       <!--End Logg inn-->

        <script>
            var lati=14.883333;
            var longi=5.26;
            var midpoint={lat:lati, lng:longi};
            var x = document.getElementById("demo");
            var markersArray=[];
            
            // Initialize and add the map
            function initMap() {
              // The location of Uluru
              var yourPos = {lat: lati, lng: longi};
              // The map, centered at Uluru
              map = new google.maps.Map(
                  document.getElementById('map'), {zoom: 4, center: yourPos});
              // The marker, positioned at Uluru
              marker = new google.maps.Marker({position: yourPos, map: map});
              markersArray.push(marker);
              geocoder = new google.maps.Geocoder();
              }
            
            function geocodeAddress() {
              const address = document.getElementById("search").value;
              geocoder.geocode({ address: address }, (results, status) => {
                if (status === "OK") {
                  clearOverlays();
                  map.setCenter(results[0].geometry.location);
                  marker = new google.maps.Marker({
                    map: map,
                    position: results[0].geometry.location,
                  });
                  markersArray.push(marker);
                  map.setZoom(17);
                } else {
                  alert("Geocode was not successful for the following reason: " + status);
                }
              });
            }
            
            function getLocation() {
              if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(showPosition, showError);
              } else { 
                x.innerHTML = "Geolocation is not supported by this browser.";
              }
            }

            function showPosition(position) {
                lati= position.coords.latitude;
                longi=position.coords.longitude;
                x.innerHTML = "Latitude: " + lati +
                "<br>Longitude: " + longi;
            }

            function showError(error) {
              switch(error.code) {
                case error.PERMISSION_DENIED:
                  x.innerHTML = "User denied the request for Geolocation."
                  break;
                case error.POSITION_UNAVAILABLE:
                  x.innerHTML = "Location information is unavailable."
                  break;
                case error.TIMEOUT:
                  x.innerHTML = "The request to get user location timed out."
                  break;
                case error.UNKNOWN_ERROR:
                  x.innerHTML = "An unknown error occurred."
                  break;
              }
            }
            
            function moveMap() {
                if(lati==14.883333 && longi==5.26){
                        alert("Trykk 'Try it' først, for å hente posisjon");
                    }
                   
                else{
                        clearOverlays();
                        midpoint={lat:lati, lng:longi};
                        map.setCenter(midpoint);
                        map.panTo(midpoint);
                        map.setZoom(15);
                        marker = new google.maps.Marker({position: midpoint, map: map});
                        markersArray.push(marker);
                    }

            }
            
            function clearOverlays() {
              for (var i = 0; i < markersArray.length; i++ ) {
                markersArray[i].setMap(null);
              }
              markersArray.length = 0;
            }
            


        </script>
        <script defer
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB3B26T_Ul5DDDxv_ZGKa2icTY3Dcm7zE0&callback=initMap">
        </script>
            <!--
            Get longitude and latitude
            https://www.w3schools.com/html/html5_geolocation.asp
            -->
        
         <div id = "footer">
             ...
         </div>  
        
        </div>
    </body>
</html>
